---
name: pr-learning
description: PRの内容からコーディング規則や実装パターンを学習し、知識として蓄積するスキル
---

# PR Learning Skill

実装されたPullRequestから、コーディング規則や書き方を学習し、スキルとして蓄積するためのスキルです。

## 機能

このスキルは以下のタスクを実行します：

1. **PRの特定と取得**
   - `gh`コマンドを使用して現在のブランチに関連するPRを特定
   - PRの詳細情報（diff、コメント、レビュー内容）を取得

2. **学習要素の抽出**
   - コーディングスタイルとパターンの分析
   - 使用されているライブラリや技術の特定
   - アーキテクチャや設計パターンの識別
   - エラーハンドリングやテスト戦略の確認

3. **学習内容の構造化**
   - 言語・技術スタック別の整理
   - 再利用可能なパターンの抽出
   - ベストプラクティスの特定
   - アンチパターンの識別

4. **学習レポートの生成**
   - Markdown形式での学習内容出力
   - カテゴリ別の整理（言語、フレームワーク、パターン等）
   - 具体的なコード例の引用
   - 今後の実装で活用できるポイントの明記

## 学習対象

### コーディング規則
- 命名規則（変数、関数、クラス名）
- インデントやフォーマットスタイル
- コメントの書き方
- import/requireの整理方法

### 実装パターン
- エラーハンドリングパターン
- 非同期処理の書き方
- データ変換・処理パターン
- API設計パターン

### 技術選択
- 使用ライブラリとその選定理由
- 設定ファイルの管理方法
- テスト戦略とツール選択
- デプロイメント手法

### 設計思想
- アーキテクチャパターン
- 責任分離の方法
- 拡張性への配慮
- パフォーマンス最適化

## 出力形式

```markdown
# PR学習レポート: [PR Title]

## 概要
- PR URL: [GitHub PR URL]
- 変更ファイル数: X件
- 追加行数: +XXX, 削除行数: -XXX
- 主な変更内容: [概要]

## 学習ポイント

### コーディングスタイル
- [具体的なスタイルの特徴]
- [コード例]

### 技術選択
- [使用された技術・ライブラリ]
- [選択理由や利点]

### 実装パターン
- [特徴的な実装パターン]
- [再利用可能な部分]

### 改善点・学び
- [今後活用できるポイント]
- [避けるべきアンチパターン]

## アクションアイテム
- [ ] [学んだ内容を他のプロジェクトに適用]
- [ ] [関連ドキュメントの作成・更新]
- [ ] [チーム内での知識共有]
```

## 使用方法

1. PRが作成されているブランチで実行
2. スキルが自動的にPR情報を取得・分析
3. 学習レポートがMarkdown形式で出力される
4. 必要に応じて学習内容をスキルとして保存

## 期待される効果

- 実装経験からの継続的な学習
- チーム内のコーディング規則の統一
- ベストプラクティスの蓄積と共有
- 技術的負債の早期発見と改善

## 学習内容の保存

学習レポート出力後、重要なパターンは以下に保存してください：

**保存先**: `~/.claude/context/learnings/`

### 保存手順

1. 該当する言語/フレームワークのファイルを開く
2. 推奨パターンまたはアンチパターンとして追記
3. 学習元（PR番号、日付）を明記

### 保存先ファイル一覧

| ファイル | 対象 |
|---------|------|
| `typescript.md` | TypeScript固有のパターン |
| `react.md` | React（コア機能、Hooks等） |
| `react-router.md` | React Router |
| `vue.md` | Vue / Nuxt |
| `rails.md` | Ruby on Rails |
| `python.md` | Python |
| `nestjs.md` | NestJS |
| `general.md` | 言語非依存の汎用パターン |

### 保存例

TypeScriptのバリデーションパターンを学習した場合：

```markdown
### zodを使った型安全なバリデーション
**学習元**: PR#123 (2024-12-19)

**説明**:
外部入力のバリデーションにはzodを使用し、型推論と実行時検証を一元化する。

**コード例**:
```typescript
import { z } from 'zod';

const userSchema = z.object({
  email: z.string().email(),
  age: z.number().min(0).max(150),
});

type User = z.infer<typeof userSchema>;
```

**理由**:
- 型定義とバリデーションロジックの二重管理を防止
- 型推論が自動で行われる
- エラーメッセージがわかりやすい
```

→ `~/.claude/context/learnings/typescript.md` の「推奨パターン」セクションに追記

## コードレビュースキルとの連携

保存した学習内容は、以下のレビュースキル実行時に自動参照されます：

- `code-review-bugs`: バグ検出時にアンチパターンをチェック
- `code-review-maintainability`: 保守性レビューで推奨パターンを参照
- `code-review-simplify`: シンプル化提案で代替パターンを提案

この連携により、学習 → 蓄積 → レビュー → 改善のサイクルが形成されます。